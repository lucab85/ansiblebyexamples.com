
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://www.ansiblebyexamples.com/Getting%20Started/Windows%20Hosts/">
      
      
        <link rel="prev" href="../Ubuntu%2024.04%20LTS/">
      
      
        <link rel="next" href="../../Playbook/">
      
      
      <link rel="icon" href="../../fontawesome/solid/a">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>Windows Hosts - Ansible By Examples</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans:300,300i,400,400i,700,700i%7CIBM+Plex+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"IBM Plex Sans";--md-code-font:"IBM Plex Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#how-to-configure-a-windows-host-for-ansible" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Ansible By Examples" class="md-header__button md-logo" aria-label="Ansible By Examples" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M221.5 51.7C216.6 39.8 204.9 32 192 32s-24.6 7.8-29.5 19.7l-120 288-40 96c-6.8 16.3.9 35 17.2 41.8s35-.9 41.8-17.2L93.3 384h197.3l31.8 76.3c6.8 16.3 25.5 24 41.8 17.2s24-25.5 17.2-41.8l-40-96-120-288zM264 320H120l72-172.8z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ansible By Examples
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Windows Hosts
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="deep-orange"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="green" data-md-color-accent="deep-purple"  aria-label="Dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../.." class="md-tabs__link">
          
  
  Welcome

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
  Getting Started

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Playbook/" class="md-tabs__link">
          
  
  Playbook

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../Materials/" class="md-tabs__link">
          
  
  Materials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../blog/" class="md-tabs__link">
          
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Ansible By Examples" class="md-nav__button md-logo" aria-label="Ansible By Examples" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M221.5 51.7C216.6 39.8 204.9 32 192 32s-24.6 7.8-29.5 19.7l-120 288-40 96c-6.8 16.3.9 35 17.2 41.8s35-.9 41.8-17.2L93.3 384h197.3l31.8 76.3c6.8 16.3 25.5 24 41.8 17.2s24-25.5 17.2-41.8l-40-96-120-288zM264 320H120l72-172.8z"/></svg>

    </a>
    Ansible By Examples
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Welcome
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Ubuntu%2024.04%20LTS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ubuntu 24.04 LTS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Windows Hosts
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Windows Hosts
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configure-a-windows-host-for-ansible" class="md-nav__link">
    <span class="md-ellipsis">
      Configure a Windows Host for Ansible
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playbook" class="md-nav__link">
    <span class="md-ellipsis">
      Playbook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Playbook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-node" class="md-nav__link">
    <span class="md-ellipsis">
      Windows node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-an-ansible-user" class="md-nav__link">
    <span class="md-ellipsis">
      Create an "ansible" user
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-powershell-net-and-set-up-winrm" class="md-nav__link">
    <span class="md-ellipsis">
      Verify PowerShell, .NET and set up WinRM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible-controller" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Controller
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ansible Controller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    <span class="md-ellipsis">
      code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execution" class="md-nav__link">
    <span class="md-ellipsis">
      execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Playbook
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Playbook
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Playbook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Playbook/Using%20Date%20Time%20and%20Timestamp%20in%20Ansible%20Playbook/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using Date Time and Timestamp in Ansible Playbook
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Materials
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Materials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Materials/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Materials/books/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Books
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_2" >
        
          
          <label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_2">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/archive/2025/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2025
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Categories
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Categories
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    
  
  
    <li class="md-nav__item">
      <a href="../../blog/category/events/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Events
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configure-a-windows-host-for-ansible" class="md-nav__link">
    <span class="md-ellipsis">
      Configure a Windows Host for Ansible
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#links" class="md-nav__link">
    <span class="md-ellipsis">
      Links
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#playbook" class="md-nav__link">
    <span class="md-ellipsis">
      Playbook
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Playbook">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#windows-node" class="md-nav__link">
    <span class="md-ellipsis">
      Windows node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Windows node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-an-ansible-user" class="md-nav__link">
    <span class="md-ellipsis">
      Create an "ansible" user
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-powershell-net-and-set-up-winrm" class="md-nav__link">
    <span class="md-ellipsis">
      Verify PowerShell, .NET and set up WinRM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible-controller" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible Controller
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ansible Controller">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#code" class="md-nav__link">
    <span class="md-ellipsis">
      code
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#execution" class="md-nav__link">
    <span class="md-ellipsis">
      execution
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="how-to-configure-a-windows-host-for-ansible">How to configure a Windows Host for Ansible?</h1>
<p>I'll show you step by step on a freshly installed machine how to configure a "basic" authentication, use a Local Accounts for authentication and successfully execute a simple "win_ping" Ansible Playbook.
This initial configuration sometimes is a roadblock for some Windows users to start using Ansible.
I'm Luca Berton and welcome to today's episode of Ansible Pilot.</p>
<iframe width="560" height="315"
src="https://www.youtube.com/embed/-vPXS8UuJoI"
frameborder="0" allowfullscreen>
</iframe>

<h2 id="configure-a-windows-host-for-ansible">Configure a Windows Host for Ansible</h2>
<ul>
<li>Windows 7, 8.1, 10, 11</li>
<li>Windows Server 2008, 2008 R2, 2012, 2012 R2, 2016, 2019, 2022</li>
<li>PowerShell 3.0+ and .NET 4.0+</li>
<li>WinRM or OpenSSH (experimental)</li>
</ul>
<p>The supported nodes include all the modern releases of Windows Desktop and Server.
The full list includes Windows 7, 8.1, 10, 11, and Windows Server 2008, 2008 R2, 2012, 2012 R2, 2016, 2019, 2022.
Ansible requires PowerShell 3.0 or newer and at least .NET 4.0 to be installed on the Windows host.
You need to upgrade only old Windows 7 and Windows Server 2008 nodes.
The communication between Ansible Controller and the target node is executed via a WinRM listener that needs to be created and activated.
Ansible 2.8 has added an experimental SSH connection for Windows-managed nodes for Windows 10+ clients and Windows Server 2019+.
In this example, we're going to cover the WinRM connection method with "basic" authentication.
Refer to manual for more WinRM wide range of configuration options.</p>
<h2 id="links">Links</h2>
<ul>
<li><a href="https://docs.ansible.com/ansible/latest/user_guide/windows_setup.html">Setting up a Windows Host</a></li>
<li><a href="https://docs.ansible.com/ansible/latest/user_guide/windows_winrm.html">Windows Remote Management</a></li>
</ul>
<h2 id="playbook">Playbook</h2>
<p>How to configure a Windows Host for Ansible connections.</p>
<ul>
<li>Create a user</li>
<li>verify PowerShell &amp; .NET</li>
<li>setup WinRM</li>
<li>create Inventory &amp; Playbook</li>
</ul>
<p>First of all, I'd suggest creating a user to run Ansible automation. This user needs to be Power User or have Administrative privileges in order to execute some Ansible code.
Second, you need to verify that PowerShell and .NET versions, modern operating systems already meet the requirements.
The most important part is to set up the WinRM. There is a great PowerShell script that sets up both HTTP and HTTPS listeners with a self-signed certificate and enables the Basic authentication option on the service.
Once everything is done on the node you could configure the Ansible inventory on the Ansible Controller machine and run your first Ansible Playbook with the <code>win_ping</code> module to verify the successful configuration.</p>
<h3 id="windows-node">Windows node</h3>
<h4 id="create-an-ansible-user">Create an "ansible" user</h4>
<ol>
<li>open Computer Management (right-click from "This PC" &gt; "Manage")</li>
</ol>
<p><img alt="open Computer Management" src="/assets/ansible_configure_windows1.jpg" /></p>
<ol>
<li>New User (right-click from "Users" &gt; "New User")</li>
</ol>
<p>User name: <strong>ansible</strong>
Full name: <strong>ansible</strong>
Description: <strong>ansible user</strong>
Password and Confirm password: <strong>SuperSecurePassword123@</strong>
Options: enable <code>Password never expires</code> disable <code>User must change password at next logon</code></p>
<p><img alt="New User" src="/assets/ansible_configure_windows2.jpg" /></p>
<ol>
<li>Add "ansible" user to "administrators" Group</li>
</ol>
<p><img alt="Add &quot;ansible&quot; user to &quot;administrators&quot; Group" src="/assets/ansible_configure_windows3.jpg" /></p>
<h3 id="verify-powershell-net-and-set-up-winrm">Verify PowerShell, .NET and set up WinRM</h3>
<ol>
<li>verify PowerShell version</li>
</ol>
<div class="language-PowerShell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">Windows</span> <span class="n">PowerShell</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">Copyright</span> <span class="p">(</span><span class="n">C</span><span class="p">)</span> <span class="n">Microsoft</span> <span class="n">Corporation</span><span class="p">.</span> <span class="n">All</span> <span class="n">rights</span> <span class="n">reserved</span><span class="p">.</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">Try</span> <span class="n">the</span> <span class="n">new</span> <span class="n">cross-platform</span> <span class="n">PowerShell</span> <span class="n">https</span><span class="p">://</span><span class="n">aka</span><span class="p">.</span><span class="n">ms</span><span class="p">/</span><span class="n">pscore6</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="nb">Get-Host</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">Version</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="n">Version</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="p">-------</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="n">5</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">19041</span><span class="p">.</span><span class="n">1237</span>
</span></code></pre></div>
<ol>
<li>verify .NET version</li>
</ol>
<div class="language-PowerShell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="nb">Get-ChildItem</span> <span class="s1">&#39;HKLM:\SOFTWARE\Microsoft\NET Framework Setup\NDP&#39;</span> <span class="n">-Recurse</span> <span class="p">|</span> <span class="nb">Get-ItemProperty</span> <span class="n">-Name</span> <span class="n">version</span> <span class="n">-EA</span> <span class="n">0</span> <span class="p">|</span> <span class="nb">Where </span><span class="p">{</span> <span class="nv">$_</span><span class="p">.</span><span class="n">PSChildName</span> <span class="o">-Match</span> <span class="s1">&#39;^(?!S)\p{L}&#39;</span><span class="p">}</span> <span class="p">|</span> <span class="nb">Select </span><span class="n">PSChildName</span><span class="p">,</span> <span class="n">version</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="p">&gt;&gt;</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">PSChildName</span> <span class="n">Version</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="p">-----------</span> <span class="p">-------</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="n">Client</span>      <span class="n">4</span><span class="p">.</span><span class="n">8</span><span class="p">.</span><span class="n">04084</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="n">Full</span>        <span class="n">4</span><span class="p">.</span><span class="n">8</span><span class="p">.</span><span class="n">04084</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="n">Client</span>      <span class="n">4</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span>
</span></code></pre></div>
<ol>
<li>Verify WinRM not-configured</li>
</ol>
<div class="language-PowerShell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="n">winrm</span> <span class="n">get</span> <span class="n">winrm</span><span class="p">/</span><span class="n">config</span><span class="p">/</span><span class="n">Service</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">WSManFault</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    <span class="n">Message</span> <span class="p">=</span> <span class="n">The</span> <span class="n">client</span> <span class="n">cannot</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">specified</span> <span class="k">in</span> <span class="n">the</span> <span class="n">request</span><span class="p">.</span> <span class="n">Verify</span> <span class="n">that</span> <span class="n">the</span> <span class="n">service</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">running</span> <span class="n">and</span> <span class="n">is</span> <span class="n">accepting</span> <span class="n">requests</span><span class="p">.</span> <span class="n">Consult</span> <span class="n">the</span> <span class="n">logs</span> <span class="n">and</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">the</span> <span class="n">WS-Management</span> <span class="n">service</span> <span class="n">running</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span><span class="p">,</span> <span class="n">most</span> <span class="n">commonly</span> <span class="n">IIS</span> <span class="n">or</span> <span class="n">WinRM</span><span class="p">.</span> <span class="k">If</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">,</span> <span class="n">run</span> <span class="n">the</span> <span class="n">following</span> <span class="n">command</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">to</span> <span class="n">analyze</span> <span class="n">and</span> <span class="n">configure</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">:</span> <span class="s2">&quot;winrm quickconfig&quot;</span><span class="p">.</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">Error</span> <span class="n">number</span><span class="p">:</span>  <span class="p">-</span><span class="n">2144108526</span> <span class="n">0x80338012</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="n">The</span> <span class="n">client</span> <span class="n">cannot</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">specified</span> <span class="k">in</span> <span class="n">the</span> <span class="n">request</span><span class="p">.</span> <span class="n">Verify</span> <span class="n">that</span> <span class="n">the</span> <span class="n">service</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">running</span> <span class="n">and</span> <span class="n">is</span> <span class="n">accepting</span> <span class="n">requests</span><span class="p">.</span> <span class="n">Consult</span> <span class="n">the</span> <span class="n">logs</span> <span class="n">and</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">the</span> <span class="n">WS-Management</span> <span class="n">service</span> <span class="n">running</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span><span class="p">,</span> <span class="n">most</span> <span class="n">commonly</span> <span class="n">IIS</span> <span class="n">or</span> <span class="n">WinRM</span><span class="p">.</span> <span class="k">If</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">,</span> <span class="n">run</span> <span class="n">the</span> <span class="n">following</span> <span class="n">command</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">to</span> <span class="n">analyze</span> <span class="n">and</span> <span class="n">configure</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">:</span> <span class="s2">&quot;winrm quickconfig&quot;</span><span class="p">.</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="n">winrm</span> <span class="n">get</span> <span class="n">winrm</span><span class="p">/</span><span class="n">config</span><span class="p">/</span><span class="n">Winrs</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="n">WSManFault</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    <span class="n">Message</span> <span class="p">=</span> <span class="n">The</span> <span class="n">client</span> <span class="n">cannot</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">specified</span> <span class="k">in</span> <span class="n">the</span> <span class="n">request</span><span class="p">.</span> <span class="n">Verify</span> <span class="n">that</span> <span class="n">the</span> <span class="n">service</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">running</span> <span class="n">and</span> <span class="n">is</span> <span class="n">accepting</span> <span class="n">requests</span><span class="p">.</span> <span class="n">Consult</span> <span class="n">the</span> <span class="n">logs</span> <span class="n">and</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">the</span> <span class="n">WS-Management</span> <span class="n">service</span> <span class="n">running</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span><span class="p">,</span> <span class="n">most</span> <span class="n">commonly</span> <span class="n">IIS</span> <span class="n">or</span> <span class="n">WinRM</span><span class="p">.</span> <span class="k">If</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">,</span> <span class="n">run</span> <span class="n">the</span> <span class="n">following</span> <span class="n">command</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">to</span> <span class="n">analyze</span> <span class="n">and</span> <span class="n">configure</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">:</span> <span class="s2">&quot;winrm quickconfig&quot;</span><span class="p">.</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="n">Error</span> <span class="n">number</span><span class="p">:</span>  <span class="p">-</span><span class="n">2144108526</span> <span class="n">0x80338012</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="n">The</span> <span class="n">client</span> <span class="n">cannot</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">specified</span> <span class="k">in</span> <span class="n">the</span> <span class="n">request</span><span class="p">.</span> <span class="n">Verify</span> <span class="n">that</span> <span class="n">the</span> <span class="n">service</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">running</span> <span class="n">and</span> <span class="n">is</span> <span class="n">accepting</span> <span class="n">requests</span><span class="p">.</span> <span class="n">Consult</span> <span class="n">the</span> <span class="n">logs</span> <span class="n">and</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">the</span> <span class="n">WS-Management</span> <span class="n">service</span> <span class="n">running</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span><span class="p">,</span> <span class="n">most</span> <span class="n">commonly</span> <span class="n">IIS</span> <span class="n">or</span> <span class="n">WinRM</span><span class="p">.</span> <span class="k">If</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">,</span> <span class="n">run</span> <span class="n">the</span> <span class="n">following</span> <span class="n">command</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">to</span> <span class="n">analyze</span> <span class="n">and</span> <span class="n">configure</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">:</span> <span class="s2">&quot;winrm quickconfig&quot;</span><span class="p">.</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="n">winrm</span> <span class="n">enumerate</span> <span class="n">winrm</span><span class="p">/</span><span class="n">config</span><span class="p">/</span><span class="n">Listener</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="n">WSManFault</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    <span class="n">Message</span> <span class="p">=</span> <span class="n">The</span> <span class="n">client</span> <span class="n">cannot</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">specified</span> <span class="k">in</span> <span class="n">the</span> <span class="n">request</span><span class="p">.</span> <span class="n">Verify</span> <span class="n">that</span> <span class="n">the</span> <span class="n">service</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">running</span> <span class="n">and</span> <span class="n">is</span> <span class="n">accepting</span> <span class="n">requests</span><span class="p">.</span> <span class="n">Consult</span> <span class="n">the</span> <span class="n">logs</span> <span class="n">and</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">the</span> <span class="n">WS-Management</span> <span class="n">service</span> <span class="n">running</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span><span class="p">,</span> <span class="n">most</span> <span class="n">commonly</span> <span class="n">IIS</span> <span class="n">or</span> <span class="n">WinRM</span><span class="p">.</span> <span class="k">If</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">,</span> <span class="n">run</span> <span class="n">the</span> <span class="n">following</span> <span class="n">command</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">to</span> <span class="n">analyze</span> <span class="n">and</span> <span class="n">configure</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">:</span> <span class="s2">&quot;winrm quickconfig&quot;</span><span class="p">.</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="n">Error</span> <span class="n">number</span><span class="p">:</span>  <span class="p">-</span><span class="n">2144108526</span> <span class="n">0x80338012</span>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="n">The</span> <span class="n">client</span> <span class="n">cannot</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">specified</span> <span class="k">in</span> <span class="n">the</span> <span class="n">request</span><span class="p">.</span> <span class="n">Verify</span> <span class="n">that</span> <span class="n">the</span> <span class="n">service</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">running</span> <span class="n">and</span> <span class="n">is</span> <span class="n">accepting</span> <span class="n">requests</span><span class="p">.</span> <span class="n">Consult</span> <span class="n">the</span> <span class="n">logs</span> <span class="n">and</span> <span class="n">documentation</span> <span class="k">for</span> <span class="n">the</span> <span class="n">WS-Management</span> <span class="n">service</span> <span class="n">running</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span><span class="p">,</span> <span class="n">most</span> <span class="n">commonly</span> <span class="n">IIS</span> <span class="n">or</span> <span class="n">WinRM</span><span class="p">.</span> <span class="k">If</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">is</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">,</span> <span class="n">run</span> <span class="n">the</span> <span class="n">following</span> <span class="n">command</span> <span class="n">on</span> <span class="n">the</span> <span class="n">destination</span> <span class="n">to</span> <span class="n">analyze</span> <span class="n">and</span> <span class="n">configure</span> <span class="n">the</span> <span class="n">WinRM</span> <span class="n">service</span><span class="p">:</span> <span class="s2">&quot;winrm quickconfig&quot;</span><span class="p">.</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span>
</span></code></pre></div>
<ol>
<li>Setup WinRM</li>
</ol>
<div class="language-PowerShell highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="no">[Net.ServicePointManager]</span><span class="p">::</span><span class="n">SecurityProtocol</span> <span class="p">=</span> <span class="no">[Net.SecurityProtocolType]</span><span class="p">::</span><span class="n">Tls12</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="p">&gt;&gt;</span> <span class="nv">$url</span> <span class="p">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/ansible/ansible/devel/examples/scripts/ConfigureRemotingForAnsible.ps1&quot;</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="p">&gt;&gt;</span> <span class="nv">$file</span> <span class="p">=</span> <span class="s2">&quot;$env:temp\ConfigureRemotingForAnsible.ps1&quot;</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="p">&gt;&gt;</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="p">&gt;&gt;</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">WebClient</span><span class="p">).</span><span class="n">DownloadFile</span><span class="p">(</span><span class="nv">$url</span><span class="p">,</span> <span class="nv">$file</span><span class="p">)</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="p">&gt;&gt;</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="p">&gt;&gt;</span> <span class="n">powershell</span><span class="p">.</span><span class="n">exe</span> <span class="n">-ExecutionPolicy</span> <span class="n">ByPass</span> <span class="o">-File</span> <span class="nv">$file</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span>
</span></code></pre></div>
<ol>
<li>Verify WinRM configured</li>
</ol>
<div class="language-PowerShell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="n">winrm</span> <span class="n">get</span> <span class="n">winrm</span><span class="p">/</span><span class="n">config</span><span class="p">/</span><span class="n">Service</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">Service</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>    <span class="n">RootSDDL</span> <span class="p">=</span> <span class="n">O</span><span class="p">:</span><span class="n">NSG</span><span class="p">:</span><span class="n">BAD</span><span class="p">:</span><span class="n">P</span><span class="p">(</span><span class="n">A</span><span class="p">;;</span><span class="n">GA</span><span class="p">;;;</span><span class="n">BA</span><span class="p">)(</span><span class="n">A</span><span class="p">;;</span><span class="n">GR</span><span class="p">;;;</span><span class="n">IU</span><span class="p">)</span><span class="n">S</span><span class="p">:</span><span class="n">P</span><span class="p">(</span><span class="n">AU</span><span class="p">;</span><span class="n">FA</span><span class="p">;</span><span class="n">GA</span><span class="p">;;;</span><span class="n">WD</span><span class="p">)(</span><span class="n">AU</span><span class="p">;</span><span class="n">SA</span><span class="p">;</span><span class="n">GXGW</span><span class="p">;;;</span><span class="n">WD</span><span class="p">)</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">MaxConcurrentOperations</span> <span class="p">=</span> <span class="n">4294967295</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="n">MaxConcurrentOperationsPerUser</span> <span class="p">=</span> <span class="n">1500</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>    <span class="n">EnumerationTimeoutms</span> <span class="p">=</span> <span class="n">240000</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>    <span class="n">MaxConnections</span> <span class="p">=</span> <span class="n">300</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="n">MaxPacketRetrievalTimeSeconds</span> <span class="p">=</span> <span class="n">120</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="n">AllowUnencrypted</span> <span class="p">=</span> <span class="n">true</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="n">Auth</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="n">Basic</span> <span class="p">=</span> <span class="n">true</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>        <span class="n">Kerberos</span> <span class="p">=</span> <span class="n">true</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>        <span class="n">Negotiate</span> <span class="p">=</span> <span class="n">true</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>        <span class="n">Certificate</span> <span class="p">=</span> <span class="n">false</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>        <span class="n">CredSSP</span> <span class="p">=</span> <span class="n">false</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>        <span class="n">CbtHardeningLevel</span> <span class="p">=</span> <span class="n">Relaxed</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>    <span class="n">DefaultPorts</span>
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>        <span class="n">HTTP</span> <span class="p">=</span> <span class="n">5985</span>
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>        <span class="n">HTTPS</span> <span class="p">=</span> <span class="n">5986</span>
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>    <span class="n">IPv4Filter</span> <span class="p">=</span> <span class="p">*</span>
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>    <span class="n">IPv6Filter</span> <span class="p">=</span> <span class="p">*</span>
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>    <span class="n">EnableCompatibilityHttpListener</span> <span class="p">=</span> <span class="n">false</span>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>    <span class="n">EnableCompatibilityHttpsListener</span> <span class="p">=</span> <span class="n">false</span>
</span><span id="__span-4-24"><a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>    <span class="n">CertificateThumbprint</span>
</span><span id="__span-4-25"><a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>    <span class="n">AllowRemoteAccess</span> <span class="p">=</span> <span class="n">true</span>
</span><span id="__span-4-26"><a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span>
</span><span id="__span-4-27"><a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="n">winrm</span> <span class="n">get</span> <span class="n">winrm</span><span class="p">/</span><span class="n">config</span><span class="p">/</span><span class="n">Winrs</span>
</span><span id="__span-4-28"><a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a><span class="n">Winrs</span>
</span><span id="__span-4-29"><a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>    <span class="n">AllowRemoteShellAccess</span> <span class="p">=</span> <span class="n">true</span>
</span><span id="__span-4-30"><a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>    <span class="n">IdleTimeout</span> <span class="p">=</span> <span class="n">7200000</span>
</span><span id="__span-4-31"><a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>    <span class="n">MaxConcurrentUsers</span> <span class="p">=</span> <span class="n">2147483647</span>
</span><span id="__span-4-32"><a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>    <span class="n">MaxShellRunTime</span> <span class="p">=</span> <span class="n">2147483647</span>
</span><span id="__span-4-33"><a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>    <span class="n">MaxProcessesPerShell</span> <span class="p">=</span> <span class="n">2147483647</span>
</span><span id="__span-4-34"><a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>    <span class="n">MaxMemoryPerShellMB</span> <span class="p">=</span> <span class="n">2147483647</span>
</span><span id="__span-4-35"><a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a>    <span class="n">MaxShellsPerUser</span> <span class="p">=</span> <span class="n">2147483647</span>
</span><span id="__span-4-36"><a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="n">winrm</span> <span class="n">enumerate</span> <span class="n">winrm</span><span class="p">/</span><span class="n">config</span><span class="p">/</span><span class="n">Listener</span>
</span><span id="__span-4-37"><a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a><span class="n">Listener</span>
</span><span id="__span-4-38"><a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a>    <span class="n">Address</span> <span class="p">=</span> <span class="p">*</span>
</span><span id="__span-4-39"><a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a>    <span class="n">Transport</span> <span class="p">=</span> <span class="n">HTTPS</span>
</span><span id="__span-4-40"><a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a>    <span class="n">Port</span> <span class="p">=</span> <span class="n">5986</span>
</span><span id="__span-4-41"><a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a>    <span class="n">Hostname</span> <span class="p">=</span> <span class="n">WIN10</span>
</span><span id="__span-4-42"><a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a>    <span class="n">Enabled</span> <span class="p">=</span> <span class="n">true</span>
</span><span id="__span-4-43"><a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a>    <span class="n">URLPrefix</span> <span class="p">=</span> <span class="n">wsman</span>
</span><span id="__span-4-44"><a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a>    <span class="n">CertificateThumbprint</span> <span class="p">=</span> <span class="n">F4D065F8FC6EE18F1F0FF9533584955D0C9B8E59</span>
</span><span id="__span-4-45"><a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a>    <span class="n">ListeningOn</span> <span class="p">=</span> <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">15</span><span class="p">,</span> <span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">,</span> <span class="n">169</span><span class="p">.</span><span class="n">254</span><span class="p">.</span><span class="n">20</span><span class="p">.</span><span class="n">54</span><span class="p">,</span> <span class="p">::</span><span class="n">1</span><span class="p">,</span> <span class="n">fe80</span><span class="p">::</span><span class="n">44a1</span><span class="p">:</span><span class="n">482d</span><span class="p">:</span><span class="n">5918</span><span class="p">:</span><span class="n">7cb4</span><span class="k">%</span><span class="n">4</span><span class="p">,</span> <span class="n">fe80</span><span class="p">::</span><span class="n">d017</span><span class="p">:</span><span class="n">a935</span><span class="p">:</span><span class="n">ff50</span><span class="p">:</span><span class="n">4eb4</span><span class="k">%</span><span class="n">5</span>
</span><span id="__span-4-46"><a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span> <span class="n">winrm</span> <span class="n">enumerate</span> <span class="n">winrm</span><span class="p">/</span><span class="n">config</span><span class="p">/</span><span class="n">Listener</span>
</span><span id="__span-4-47"><a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a><span class="n">Listener</span>
</span><span id="__span-4-48"><a id="__codelineno-4-48" name="__codelineno-4-48" href="#__codelineno-4-48"></a>    <span class="n">Address</span> <span class="p">=</span> <span class="p">*</span>
</span><span id="__span-4-49"><a id="__codelineno-4-49" name="__codelineno-4-49" href="#__codelineno-4-49"></a>    <span class="n">Transport</span> <span class="p">=</span> <span class="n">HTTPS</span>
</span><span id="__span-4-50"><a id="__codelineno-4-50" name="__codelineno-4-50" href="#__codelineno-4-50"></a>    <span class="n">Port</span> <span class="p">=</span> <span class="n">5986</span>
</span><span id="__span-4-51"><a id="__codelineno-4-51" name="__codelineno-4-51" href="#__codelineno-4-51"></a>    <span class="n">Hostname</span> <span class="p">=</span> <span class="n">WIN10</span>
</span><span id="__span-4-52"><a id="__codelineno-4-52" name="__codelineno-4-52" href="#__codelineno-4-52"></a>    <span class="n">Enabled</span> <span class="p">=</span> <span class="n">true</span>
</span><span id="__span-4-53"><a id="__codelineno-4-53" name="__codelineno-4-53" href="#__codelineno-4-53"></a>    <span class="n">URLPrefix</span> <span class="p">=</span> <span class="n">wsman</span>
</span><span id="__span-4-54"><a id="__codelineno-4-54" name="__codelineno-4-54" href="#__codelineno-4-54"></a>    <span class="n">CertificateThumbprint</span> <span class="p">=</span> <span class="n">F4D065F8FC6EE18F1F0FF9533584955D0C9B8E59</span>
</span><span id="__span-4-55"><a id="__codelineno-4-55" name="__codelineno-4-55" href="#__codelineno-4-55"></a>    <span class="n">ListeningOn</span> <span class="p">=</span> <span class="n">10</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">15</span><span class="p">,</span> <span class="n">127</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">1</span><span class="p">,</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">83</span><span class="p">,</span> <span class="p">::</span><span class="n">1</span><span class="p">,</span> <span class="n">fe80</span><span class="p">::</span><span class="n">94b1</span><span class="p">:</span><span class="n">dc79</span><span class="p">:</span><span class="n">39cf</span><span class="p">:</span><span class="n">8b61</span><span class="k">%</span><span class="n">4</span><span class="p">,</span> <span class="n">fe80</span><span class="p">::</span><span class="n">d017</span><span class="p">:</span><span class="n">a935</span><span class="p">:</span><span class="n">ff50</span><span class="p">:</span><span class="n">4eb4</span><span class="k">%</span><span class="n">5</span>
</span><span id="__span-4-56"><a id="__codelineno-4-56" name="__codelineno-4-56" href="#__codelineno-4-56"></a><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">vagrant</span><span class="p">&gt;</span>
</span></code></pre></div>
<h3 id="ansible-controller">Ansible Controller</h3>
<h4 id="code">code</h4>
<ul>
<li>inventory</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="p p-Indicator">[</span><span class="nv">windows</span><span class="p p-Indicator">]</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="l l-Scalar l-Scalar-Plain">windows10 ansible_host=192.168.0.59</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="l l-Scalar l-Scalar-Plain">[windows:vars]</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="l l-Scalar l-Scalar-Plain">ansible_user=ansible</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="l l-Scalar l-Scalar-Plain">ansible_password=SuperSecurePassword123@</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="l l-Scalar l-Scalar-Plain">ansible_port=5986</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="l l-Scalar l-Scalar-Plain">ansible_connection=winrm</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="l l-Scalar l-Scalar-Plain">ansible_winrm_transport=basic</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="l l-Scalar l-Scalar-Plain">ansible_winrm_server_cert_validation=ignore</span>
</span></code></pre></div>
<ul>
<li>win_ping.yml</li>
</ul>
<div class="language-yaml highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nn">---</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">win_ping module Playbook</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="nt">hosts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">windows</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span><span class="nt">become</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">  </span><span class="nt">gather_facts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="w">  </span><span class="nt">tasks</span><span class="p">:</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test connection</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="w">      </span><span class="nt">ansible.windows.win_ping</span><span class="p">:</span>
</span></code></pre></div>
<h4 id="execution">execution</h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>ansible-pilot<span class="w"> </span>$<span class="w"> </span>ansible-playbook<span class="w"> </span>-i<span class="w"> </span>windows/inventory<span class="w"> </span>windows/win_ping.yml
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>PLAY<span class="w"> </span><span class="o">[</span>win_ping<span class="w"> </span>module<span class="w"> </span>Playbook<span class="o">]</span><span class="w"> </span>***********************************************************************
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>TASK<span class="w"> </span><span class="o">[</span><span class="nb">test</span><span class="w"> </span>connection<span class="o">]</span><span class="w"> </span>****************************************************************************
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>ok:<span class="w"> </span><span class="o">[</span>windows10<span class="o">]</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>PLAY<span class="w"> </span>RECAP<span class="w"> </span>****************************************************************************************
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>windows10<span class="w">                  </span>:<span class="w"> </span><span class="nv">ok</span><span class="o">=</span><span class="m">1</span><span class="w">    </span><span class="nv">changed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">unreachable</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">failed</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">skipped</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">rescued</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">ignored</span><span class="o">=</span><span class="m">0</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>ansible-pilot<span class="w"> </span>$
</span></code></pre></div>
<p><a href="https://github.com/lucab85/ansible-pilot">code with ❤️ in GitHub</a></p>
<h2 id="conclusion">Conclusion</h2>
<p>Now you know Configure a Windows Host for Ansible.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../Ubuntu%2024.04%20LTS/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Ubuntu 24.04 LTS">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Ubuntu 24.04 LTS
              </div>
            </div>
          </a>
        
        
          
          <a href="../../Playbook/" class="md-footer__link md-footer__link--next" aria-label="Next: Overview">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copywright &copy; 2025 Luca Berton
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://example" target="_blank" rel="noopener" title="example" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305m-317.51 213.508V175.185l142.739 81.205z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://example" target="_blank" rel="noopener" title="example" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.footer", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>